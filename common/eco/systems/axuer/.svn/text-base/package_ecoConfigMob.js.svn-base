!function(e,t){function n(e,t,n){2==arguments.length&&(t=[],n=t),this.id=e,this.dependencyIds=t,this.dependencies={},this.factory=n,this.status=c.CREATED,this.exports={},this._enable=!0,this.nameSpace=null}function s(e){this.name=e,this._data={_env:""},this._meta={name:"",version:"",description:"",author:"",participator:""},this.childNames=[],this.children={},this.parent=null,this.moduleIds=[],this.modules={},this.taskIds=[],this.tasks={},this.serviceIds=[],this.services={},this.workflowIds=[],this.workflows={},this.configData={base:"/",nameSpaces:{},fullNameSpaces:{},modules:{},fullModules:{}},this.status=0}function o(e,t,n){this.context=e,this.id=t,this.sequenceTask=n}function r(e,t){1==arguments.length&&a.isObject(e)&&(t=e,e="_anonymous_aspect_"+a.uid()),0==arguments.length&&(e="_anonymous_aspect_"+a.uid());var n={};return n.id=e,n.advice=t?t:{},n.pointCut=r.pointCut,n._wrapperFunc=r._wrapperFunc,n}if(!e.eco){var a={};a.isType=function(e){return function(t){return{}.toString.call(t)=="[object "+e+"]"}},a.isObject=a.isType("Object"),a.isString=a.isType("String"),a.isArray=Array.isArray||a.isType("Array"),a.isFunction=a.isType("Function"),a.isUndefined=a.isType("Undefined"),a.isBoolean=a.isType("Boolean"),a.isNumber=a.isType("Number"),a.isInArray=function(e,t){for(i=0;i<e.length;i++)if(e[i]==t)return!0;return!1},a._uid=0,a.uid=function(){return a._uid++},function(e){function n(n,s,u,l){u="utf-8",l=t;var p=d.test(n);if(!p&&r){var f;try{importScripts(n)}catch(m){f=m}return void s(f)}var v=a.createElement(p?"link":"script");u&&(v.charset=u),e.isUndefined(l)||v.setAttribute("crossorigin",l),i(v,s,p,n),p?(v.rel="stylesheet",v.href=n):(v.async=!0,v.src=n),o=v,h?c.insertBefore(v,h):c.appendChild(v),o=null}function i(t,n,i,o){function r(e){t.onload=t.onerror=t.onreadystatechange=null,t.rel||c.removeChild(t),t=null,n(e)}var a="onload"in t;return!i||!u&&a?void(a?(t.onload=r,t.onerror=function(){e.emit("error",{uri:o,node:t}),r(!0)}):t.onreadystatechange=function(){/loaded|complete/.test(t.readyState)&&r()}):void setTimeout(function(){s(t,n)},1)}function s(e,t){var n,i=e.sheet;if(u)i&&(n=!0);else if(i)try{i.cssRules&&(n=!0)}catch(o){"NS_ERROR_DOM_SECURITY_ERR"===o.name&&(n=!0)}setTimeout(function(){n?t():s(e,t)},20)}var o,r="undefined"==typeof window&&"undefined"!=typeof importScripts&&isFunction(importScripts),a=document,c=a.head||a.getElementsByTagName("head")[0]||a.documentElement,h=c.getElementsByTagName("base")[0],d=/\.css(?:\?|$)/i,u=+navigator.userAgent.replace(/.*(?:AppleWebKit|AndroidWebKit)\/?(\d+).*/i,"$1")<536;e.request=n}(a),a.extend=function(e,t,n,i){var s;if(!t)return e;a.isArray(n)&&(i=n,n=!1),a.isArray(i)&&0==i.length&&(i=!1);for(s in t)a.isArray(i)&&!a.isInArray(i,s)||e!==t[s]&&(a.isObject(t[s])&&n&&(e[s]||(e[s]={}),a.extend(e[s],t[s],n)),e[s]=t[s]);return e},a.events={},a.on=function(e,t){var n=this.events[e]||(this.events[e]=[]);return n.push(t),this},a.one=function(e,t){var n=this,i=function(s){n.off(e,i),t.call(n,s)};return n.on(e,i),this},a.off=function(e,t){if(!e&&!t)return this.events={},this;var n=this.events[e];if(n)if(t)for(var i=n.length-1;i>=0;i--)n[i]===t&&n.splice(i,1);else delete this.events[e];return this},a.emit=function(e,t){var n=a.events[e];if(n){n=n.slice();for(var i=0,s=n.length;s>i;i++)n[i](t)}return a};var c=n.STATUS={VIRTUAL:-1,CREATED:0,READY:1,EXECUTING:2,EXECUTED:3};n.prototype.exec=function(){if(!this._enable)throw new Error("模块"+this.id+"处于不可用的状态");if(this.status>=c.EXECUTING)return this.exports;this.status=c.EXECUTING;for(var e=[],t=0;t<this.dependencyIds.length;t++)e.push(this.dependencies[this.dependencyIds[t]].exec());return this.exports=a.isFunction(this.factory)?this.factory.apply(this,e):this.factory,this.status=c.EXECUTED,this.exports},n.prototype.setDependencies=function(){if(this.dependencyIds)for(var e=0;e<this.dependencyIds.length;e++){var t=this.dependencyIds[e],n=this.nameSpace.searchModuleById(t);n.setDependencies(),this.dependencies[t]=n}},n.prototype.disable=function(){this._enable=!1},n.prototype.enable=function(){this._enable=!0},n.prototype.isEnable=function(){return this._enable},s.prototype.util=a,s.prototype.namespace=function(t,n){e[t]||(e[t]=new s(t),e[t].parent=this,this.childNames.push(t),this.children[t]=e[t]),n&&n(e[t])},s.prototype.data=function(e,t){var n=arguments.length,i=null,s=e,o="";return-1!=e.indexOf(".")&&(s=e.split(".")[0],o=e.split(".")[1]),1==n&&(this._data._env&&!o&&(o=this._data._env),o?(a.isObject(this._data[s][o])&&(i={},a.extend(i,this._data[s]._global),a.extend(i,this._data[s][o])),i=this._data[s][o]):i=this._data[s]._global),2==n&&(this._data[s]||(this._data[s]={_global:{}},o||(this._data[s]._global=t)),a.isObject(t)?(a.isObject(this._data[s]._global)||(this._data[s]._global={}),a.isObject(this._data[s][o])||(this._data[s][o]={}),o?a.extend(this._data[s][o],t):a.extend(this._data[s]._global,t)):o?this._data[s][o]=t:this._data[s]._global=t,i=this),i},s.prototype.env=function(e){var t=e,n="";return-1!=e.indexOf(".")&&(n=e.split(".")[0],t=e.split(".")[1]),this._data._env=t,n&&(this._data[n]._env=t),this},s.prototype.meta=function(e){return e?void a.extend(this._meta,e):this._meta},s.prototype.searchModuleById=function(t){var n=this.modules[t];if(-1!=t.indexOf(".")){var i=t.split(".")[0],t=t.split(".")[1],s=e[i];if(!s)throw Error("模块："+t+",所在的命名空间："+i+"不存在");n=s.searchModuleById(t)}else if(!n){var o=this.configData.modules[t]?this.configData.base+this.configData.modules[t]:this.configData.fullModules[t];if(o)n={url:o,id:t,nameSpace:this,status:c.VIRTUAL};else{if(!this.parent)throw Error("模块："+t+",在命名空间树中未查询到");n=this.parent.searchModuleById(t)}}return n},s.prototype.getUrlByNameSpaceName=function(e){var t=this.configData.nameSpaces[e]?this.configData.base+this.configData.nameSpaces[e]:this.configData.fullNameSpaces[e];return t||this.parent&&(t=this.parent.getUrlByNameSpaceName(e)),t};var h={ERROR:-1,INIT:0,FETCHING:1,FETCHED:2},d={};s.prototype.loadNameSpaces=function(t,n){function i(){for(var o=!0,r=0;r<t.length;r++){var c=t[r];if(!e[c]||0==e[c].status){o=!1;break}}o&&(a.off("nameSpaceReady",i),n.call(s))}for(var s=this,o=0;o<t.length;o++){var r=t[o],c=this.getUrlByNameSpaceName(r);if(c&&(!d[c]||d[c]<h.FETCHING))!function(t){d[c]=h.FETCHING,a.request(c,function(n){if(n===!0)throw d[c]=h.ERROR,Error("命名空间"+module.nameSpace.name+"中加载命名空间:"+t+",发生错误："+n);d[c]=h.FETCHED,e[t].status=1,a.emit("nameSpaceReady")})}(r);else{if(!e[r])throw Error("命名空间"+module.nameSpace.name+"中未找到要加载的命名空间:"+r+"的配置且这个命名空间不存在");e[r].status=1}}a.on("nameSpaceReady",i),i()},s.prototype.loadModules=function(e,t){function n(){if(!n.locked){for(var s=!0,o=0;o<e.length;o++){var r=e[o],h=i.searchModuleById(r);if(h.status<=c.CREATED){s=!1;break}}s&&(n.locked=!0,a.off("moduleReady",n),t.call(i))}}for(var i=this,s=0;s<e.length;s++){var o=e[s],r=this.searchModuleById(o),u=r.url;u&&(!d[u]||d[u]<h.FETCHING)&&!function(e){var t=e.url;d[t]=h.FETCHING,a.request(t,function(n){if(n===!0)throw d[t]=h.ERROR,Error("命名空间"+e.nameSpace.name+"中加载模块:"+e.id+",发生错误："+n);d[t]=h.FETCHED,-1!=t.indexOf(".css")?e.nameSpace.define(o,[],function(){}):a.emit("loadDependencies")})}(r)}n.locked=!1,a.on("moduleReady",n),n()},s.prototype.config=function(e){a.extend(this.configData,e)},s.prototype.define=function(e,t,i){2==arguments.length&&(i=t,t=[]);var s=this,o=new n(e,t,i);return o.nameSpace=this,this.moduleIds.push(e),this.modules[e]=o,0==t.length?(o.status=c.READY,a.emit("moduleReady")):a.one("loadDependencies",function(){s.loadModules(t,function(){o.status=c.READY,a.emit("moduleReady")})}),this},s.prototype.use=function(e,t,n){function i(){for(var e=this,i=[],s=0;s<t.length;s++){var o=e.searchModuleById(t[s]);o.setDependencies();var r=o.exec();i.push(r)}n.apply(e,i)}if(a.isString(e)&&(e=[e]),3==arguments.length&&a.isString(t)&&(t=[t]),2==arguments.length&&(n=t,t=e,e=[]),1!=arguments.length){for(var s=0;s<t.length;s++){var o=t[s];if(-1!=o.indexOf(".")){var r=o.split(".")[0];a.isInArray(e,r)||e.push(r)}}a.isInArray(e,this.name)||e.push(this.name),e&&e.length>0?this.loadNameSpaces(e,function(){a.emit("loadDependencies"),this.loadModules(t,i)}):(a.emit("loadDependencies"),this.loadModules(t,i))}else{a.emit("loadDependencies"),t=e,e=[],n=function(){};for(var s=0;s<t.length;s++){var c=t[s];if(-1!=c.indexOf("."))throw Error("同步模式不得夸命名空间调用");var h=this.searchModuleById(c);h.setDependencies(),this[c]=h.exec()}}},s.prototype.showNameSpaceTree=function(){var e=this,t=e.childNames.join(","),n="";t&&(n="("+t+")"),console.log(e.name+n),console.log("----");for(var i=0;i<e.childNames.length;i++)e.children[t].showNameSpaceTree()},s.prototype.showModules=function(){console.log("该命名空间模块总数是:"+this.moduleIds.length),console.log("该命名空间下的模块有:"+this.moduleIds.join(","))},s.prototype.showModulesTree=function(){for(var e=0;e<this.moduleIds.length;e++)this.showModuleTree(this.moduleIds[e]),console.log("---------------")},s.prototype.showModuleTree=function(e){var t=this.modules[e],n=t.dependencyIds.join(","),i="";n&&(i="("+n+")"),console.log(t.id+i),console.log("----");for(var s=0;s<t.dependencyIds.length;s++)this.showModuleTree(t.dependencyIds[s])},s.prototype.task=function(e,t){if(a.isObject(e))for(var n in e)this.taskIds.push(n),this.tasks[n]=e[n];else this.taskIds.push(e),this.tasks[e]=t;return this},s.prototype.service=function(e,t){if(a.isObject(e))for(var n in e)this.serviceIds.push(n),this.services[n]=e[n];else this.serviceIds.push(e),this.services[e]=t;return this},o.prototype.run=function(){for(var e=this.sequenceTask,t=this.context,n=0;n<e.length;n++){var i=e[n];t.tasks[i].call(t,t.services,t.tasks)}},s.prototype.run=function(e){this.workflows[e].run()},s.prototype.workflow=function(e,t){return 1==arguments.length&&a.isArray(e)&&(t=e,e="_anonymous_workflow_"+a.uid()),2==arguments.length&&a.isString(t)&&(t=[t]),this.workflowIds.push(e),this.workflows[e]=new o(this,e,t),this.workflows[e]},r.getMethodName=function(e){return e.name||e.toString().match(/function\s*([^(]*)\(/)[1]},r.getClassName=function(e){return r.getMethodName(e.constructor)},r.pointCut=function(t,n){if(1==arguments.length)if(a.isObject(t)){n=[];for(p in t)a.isFunction(t[p])&&n.push(p)}else n=t,t=e;a.isString(n)&&(n=[n]);for(var i=0;i<n.length;i++){var s=n[i];t[s]=this._wrapperFunc(t,s)}},r._exclused=["before","after","around","throwing"],r._wrapperFunc=function(e,t){var n=e[t],i=a.extend({},this.advice);e._eventAdvices||(e._eventAdvices={}),e._eventAdvices[t]||(e._eventAdvices[t]=a.extend({},a,!0,["events","on","off","one","emit"]));var s=e._eventAdvices[t];return function(){for(p in i)a.isFunction(i[p])&&!a.isInArray(r._exclused,p)&&s.on(p,function(e){i.joinPoint.eventDatas[p]=e,i[p].call(i,i.joinPoint)});try{var o={context:e,contextName:r.getClassName(e),target:n,targetName:t,arguments:arguments,result:"",error:"",stop:!1,eventDatas:{}};if(i.joinPoint=o,s.joinPoint||(s.joinPoint=o),i.before&&(i.before(o),o.stop))return;if(i.around){if(i.around(o),o.stop)return}else o.result=n.apply(e,arguments);if(i.after&&(i.after(o),o.stop))return}catch(c){i.throwing&&i.throwing(o)}return o.result}},s.prototype.Aspect=r,e.eco=new s("eco")}}(this);
!function(){var e="../../common/eco/";if(window.eventConfig&&window.eventConfig.cdnHost){var n="/site";-1!=window.eventConfig.cdnHost.indexOf("t.tuniucdn.com")&&(n=""),e=window.eventConfig.cdnHost+n+"/event/common/eco/"}eco.config({base:e,modules:{zepto:"lib/zepto/1.1.6/zepto.min.js",zData:"lib/zepto/extends/data/data.min.js",zFx:"lib/zepto/extends/fx/fx.min.js",zTouch:"lib/zepto/extends/touch/touch.min.js",zSelector:"lib/zepto/extends/selector/selector.min.js",iscroll:"components/iscroll/eui.iscroll.min.js",countDown:"components/countDown/eui.countDown.min.js",marquee:"components/marquee/eui.marquee.min.js",unveil:"components/unveil/eui.unveil.min.js",dialog:"components/dialog/eui.dialog.min.js",address:"components/address/eui.address.min.js",stat:"plugins/stat/stat.min.js",template:"plugins/template/template.min.js",servertime:"plugins/servertime/servertime.min.js",moment:"plugins/moment/moment.min.js",md5:"plugins/md5/md5.min.js",base64:"plugins/base64/base64.min.js",exif:"lib/exif/exif.min.js",imgFix:"plugins/imageFix/imageFix.min.js",loadBox:"plugins/load/load.js"}})}();
eco.namespace("mob"),mob.meta({name:"mob运营系统",author:"运营开发组",version:"0.0.1",description:"主要是运营前端系统",participator:"运营开发组"}),mob.getQueryString=function(e){var n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),t=window.location.search.substr(1).match(n);return null!=t?decodeURIComponent(t[2]):null},mob.pxToRem=function(e){var n=document.documentElement,t=n.getBoundingClientRect().width,o=640,i=100,r=t/(o/i),a=e/r;return a},mob.rootFontSize=document.documentElement.getBoundingClientRect().width/6.4,mob.remToPx=function(e){return e*mob.rootFontSize},mob.setCookie=function(e,n,t,o,i,r){var a=encodeURIComponent(e)+"="+encodeURIComponent(n);t||(t=new Date,t.setTime(t.getTime()+2592e6)),t instanceof Date&&(a+="; expires="+t.toGMTString()),o&&(a+="; path="+o),i||(i=".tuniu.com"),i&&(a+="; domain="+i),r&&(a+="; secure"),document.cookie=a},mob.getCookie=function(e){var n=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!==n?n[2]:""},mob.isApp=function(){var e=parseInt(mob.getCookie("deviceType"),10);return 0==e||1==e}(),mob.isWeixin=function(){return navigator.userAgent.toLowerCase().indexOf("micromessenger")>-1}(),mob.isM=function(){return!mob.isApp&&!mob.isWeixin}(),mob.fta=function(e){var n="/"+e.replace(new RegExp(":","gm"),"/");window.FTA&&window.FTA("",e,"",n)},mob.initWebviewBridge=function(){mob.webviewBridgeInited||(WebViewJavascriptBridge.init(function(e,n){}),mob.webviewBridgeInited=!0)},mob.webviewBridgeReady=function(e){window.WebViewJavascriptBridge?(mob.initWebviewBridge(),e(WebViewJavascriptBridge)):document.addEventListener("WebViewJavascriptBridgeReady",function(){mob.initWebviewBridge(),e(WebViewJavascriptBridge)},!1)},mob.callBridge=function(e,n,t){mob.webviewBridgeReady(function(o){o.callHandler(e,n,t)})},mob.getMultiWindowStatus=function(e){mob.callBridge("getMultiWindowStatus",{},e)},mob.setMaskInMultiWindow=function(){function e(e){if(e=JSON.parse(e)){var n=document.getElementById("mitiwindow-mask");1==e.status?n.style.display="block":n.style.display="none"}}mob.webviewBridgeReady(function(n){var t=document.body,o=document.createElement("div");o.id="mitiwindow-mask",o.style.cssText="z-index:9999;position:fixed;left:0px;top:0px;width:100%;height:100%;line-height:100%;text-align:center;background:rgba(0,0,0,0.5);font-size:18px;color:#fff;padding-top: 50%;display:none;",o.innerHTML="当前处于分屏模式下，页面不可用",t.appendChild(o),mob.getMultiWindowStatus(function(n){e(n)}),n.registerHandler("onMultiWindowsStatusChange",function(n){e(n)})})},mob.cdnHostUrl=window.eventConfig?window.eventConfig.cdnHost:"",mob.resBaseUrl=window.eventConfig?window.eventConfig.resBaseUrl:"",mob.getResUrl=function(e,n){var t="src";return n&&(t="dist"),window.eventConfig?window.eventConfig.resBaseUrl+"/event/"+e+"/dist/":"../../"+e+"/"+t+"/"},mob.getHost=function(){var e=window.location.host,n=window.location.protocol;return-1!=e.indexOf("tuniu.com")?(0!=e.indexOf("dynamic")&&(e="dynamic."+e),e=n+"//"+e):e=n+"//dynamic.m.tuniu.com",e},mob.getPFromURL=function(){for(var e=window.location.hash.slice(1).split("&").concat(window.location.search.slice(1).split("&")),n={},t=0;t<e.length;t++){var o=e[t].split("=");n[o[0]]=o[1]}return n.p},mob._updatePvalueandTel=function(){function e(e){return document.getElementById(e)}var n=mob.getHost(),t={partner:{p:mob.getPFromURL()||"",referer:encodeURIComponent(document.referrer)}};t.phone="";var o=new XMLHttpRequest;o.open("GET",n+"/event/mGlobal/index?data="+encodeURIComponent(JSON.stringify(t))),o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){var n=JSON.parse(o.responseText);if(n.success){n=n.data;var t=n.phone;t&&localStorage.setItem("400phone",t),t&&e("telConsult")&&(e("telConsult").href="tel:"+t)}}},o.withCredentials=!0,o.send(null)},mob._updatePvalueandTel();